#!/usr/bin/env ruby
 
command = ARGV.shift
 
def run(cmd)
  puts "Running #{cmd.inspect} instead"
  system(cmd)
end
 
case command
when '!!'
  fish_history = File.read("/Users/jesse/.config/fish/fish_history").split("\n")
  previous_command = fish_history.last
  run(previous_command)
when '!$'
  fish_history = File.read("/Users/jesse/.config/fish/fish_history").split("\n")
  previous_argument = fish_history.last.split("\s").last
  run(previous_command)
  
when /^git(@|:\/\/).*\.git$/
  run("git clone #{command.inspect}")
  
when /^(?:ftp|https?):\/\/.+\.t(?:ar\.)?gz$/
  run("curl #{command.inspect} | tar xzv")
  
when /^[a-z0-9_\-\/]+\.feature$/
  run("cucumber #{command}")
  
when /^[A-Za-z0-9_\-\/]+\.gem$/
  # Install a gem
  # @example
  #   haml.gem
  gem_to_install = command.first.gsub(/\.gem$/, '')
  run "sudo gem install #{gem_to_install}"
else
  $stderr.puts "No default action defined in #{__FILE__.inspect}"
  abort
end